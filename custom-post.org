#+startup: content
#+title: è‡ªå®šä¹‰é…ç½®

* è‡ªåŠ¨ä¿å­˜
#+begin_src emacs-lisp
  (require 'auto-save)
  ;; quietly sav
  (setq auto-save-silent t)
  ;; automatically delete spaces at the end of the line when saving
  ;; (setq auto-save-delete-trailing-whitespace t)
  ;; The idle seconds to auto save file.
  (setq auto-save-idle 1)
  ;; å¼€å¯è‡ªåŠ¨ä¿å­˜
  (auto-save-enable)
#+end_src
* ç¿»è¯‘
#+begin_src emacs-lisp
  ;; ;; google ç¿»è¯‘
  ;; (use-package go-translate
  ;;   :ensure t
  ;;   :config
  ;;   (defun aggron/trim-translate-text (text)
  ;;     (string-join (split-string (string-trim text)) " "))
  ;;   (defun aggron/go-translate-current-text ()
  ;;     "Get current text under cursor, selection or word."
  ;;     (cond ((eq major-mode 'pdf-view-mode)
  ;;            (if (pdf-view-active-region-p)
  ;;                (car (pdf-view-active-region-text))))
  ;;           ((use-region-p)
  ;;            (aggron/trim-translate-text (buffer-substring-no-properties (region-beginning) (region-end))))
  ;;           (t (current-word t t))))
  ;;   (setq go-translate-base-url "https://translate.google.com"
  ;;         go-translate-extra-directions '(("en" . "zh-CN"))
  ;;         go-translate-target-language "en"
  ;;         go-translate-local-language "zh-CN"
  ;;         go-translate-buffer-follow-p t
  ;;         go-translate-inputs-function #'go-translate-inputs-current-or-prompt
  ;;         go-translate-token-current (cons 430675 2721866130)
  ;;         go-translate-text-function #'aggron/go-translate-current-text
  ;;         )
  ;;   :bind
  ;;   (:map global-map
  ;;    ("C-c e y" . 'go-translate-popup-current)
  ;;    ("C-c y" . 'go-translate)
  ;;    )
  ;;   )
  ;; ;; æ’å…¥ç¿»è¯‘æ–‡å­—
  ;; (require 'insert-translated-name)
  ;; (global-set-key (kbd "C-c e e") 'insert-translated-name-insert-original-translation)
  ;; (global-set-key (kbd "C-c e v") 'insert-translated-name-insert-with-camel)
  ;; (global-set-key (kbd "C-c e u") 'insert-translated-name-insert-with-underline)
  ;; (global-set-key (kbd "C-c e r") 'insert-translated-name-replace)
  ;; ;; å†™è‹±æ–‡å¸®åŠ©
  ;; (require 'company-english-helper)
  ;; (global-set-key (kbd "C-c e h") 'toggle-company-english-helper)

  ;; google ç¿»è¯‘
  (use-package go-translate
    :ensure t
    :config
    (setq gts-translate-list '(("en" "zh")))
    ;; é…ç½®é»˜è®¤çš„ translator
    ;; è¿™äº›é…ç½®å°†è¢« gts-do-translate å‘½ä»¤ä½¿ç”¨
    (setq gts-default-translator
          (gts-translator
           :picker ; ç”¨äºæ‹¾å–åˆå§‹æ–‡æœ¬ã€fromã€toï¼Œåªèƒ½é…ç½®ä¸€ä¸ª
           (gts-noprompt-picker)
           ;;(gts-noprompt-picker :texter (gts-whole-buffer-texter))
           ;;(gts-prompt-picker)
           ;;(gts-prompt-picker :single t)
           ;; (gts-prompt-picker :texter (gts-current-or-selection-texter) :single t)

           :engines ; ç¿»è¯‘å¼•æ“ï¼Œå¯ä»¥é…ç½®å¤šä¸ªã€‚å¦å¤–å¯ä»¥ä¼ å…¥ä¸åŒçš„ Parser ä»è€Œä½¿ç”¨ä¸åŒæ ·å¼çš„è¾“å‡º
           (list
            (gts-bing-engine)
            ;;(gts-google-engine)
            ;;(gts-google-rpc-engine)
            ;;(gts-deepl-engine :auth-key [YOUR_AUTH_KEY] :pro nil)
            (gts-google-engine :parser (gts-google-summary-parser))
            ;;(gts-google-engine :parser (gts-google-parser))
            ;;(gts-google-rpc-engine :parser (gts-google-rpc-summary-parser))
            (gts-google-rpc-engine :parser (gts-google-rpc-parser))
            )

           :render ; æ¸²æŸ“å™¨ï¼Œåªèƒ½ä¸€ä¸ªï¼Œç”¨äºè¾“å‡ºç»“æœåˆ°æŒ‡å®šç›®æ ‡ã€‚å¦‚æœä½¿ç”¨ childframe ç‰ˆæœ¬çš„ï¼Œéœ€è‡ªè¡Œå®‰è£… posframe

           (gts-buffer-render)
           ;;(gts-posframe-pop-render)
           ;;(gts-posframe-pop-render :backcolor "#333333" :forecolor "#ffffff")
           ;;(gts-posframe-pin-render)
           ;;(gts-posframe-pin-render :position (cons 1200 20))
           ;;(gts-posframe-pin-render :width 80 :height 25 :position (cons 1000 20) :forecolor "#ffffff" :backcolor "#111111")
           ;;(gts-kill-ring-render)
           ))

    ;; ç”¨äºä»£ç æ³¨é‡Šç¿»è¯‘ å»é™¤æ³¨é‡Štokenã€‚
    (defun aggron/trim-string (text)
      "trim newline"
      ;; (rx (or "//" "--" "/*" "*/" "^#" ";;"))
      (string-join (split-string (replace-regexp-in-string "\\(?:\\*/\\|--\\|/[*/]\\|;;\\|\\^#\\)" "" (string-trim text))) " "))
    ;; å¾…ç¿»è¯‘çš„æ–‡æœ¬
    (defun aggron/go-translate-current-text ()
      "Get current text under cursor, selection or word."
      (cond ((eq major-mode 'pdf-view-mode)
             (if (pdf-view-active-region-p)
                 (car (pdf-view-active-region-text))))
            ((use-region-p)
             (aggron/trim-string (buffer-substring-no-properties (region-beginning) (region-end))))
            (t (current-word t t))))

    ;; go-translate å®šåˆ¶texter
    (defclass aggron/gts-code-comment-texter (gts-texter) ())
    ;; go-translate texter gts-text å®ç°
    (cl-defmethod gts-text ((_ aggron/gts-code-comment-texter))
      (aggron/go-translate-current-text))

    ;; ä»£ç æ³¨é‡Šç¿»è¯‘tranlater
    (defvar aggron/translate-code-comment-tranlater
      (gts-translator
       :picker (gts-noprompt-picker
                :texter (aggron/gts-code-comment-texter))
       :engines (list
                 (gts-google-engine)
                 (gts-bing-engine))
       ;; render
       :render (gts-buffer-render)
       ))

    ;; ç¿»è¯‘ä»£ç æ³¨é‡Šå‘½ä»¤ã€‚å»é™¤"//"ç­‰æ³¨é‡Štokenå’Œæ¢è¡Œã€‚
    (defun aggron/translate-code-comment-command ()
      (interactive)
      (gts-translate aggron/translate-code-comment-tranlater))

    ;; å°†ç¿»è¯‘æ”¾å…¥å‰ªåˆ‡æ¿
    (defvar aggron/translate-copy-tranlater
      (gts-translator
       :picker (gts-noprompt-picker
                :texter (aggron/gts-code-comment-texter))
       :engines (list
                 (gts-bing-engine)
                 (gts-google-engine))
       :render (gts-kill-ring-render)
       ))

    (defun aggron/translate-comment-copy-command()
      (interactive)
      (gts-translate aggron/translate-copy-tranlater))
    ;; æ’å…¥ç¿»è¯‘æ–‡å­—
    (require 'insert-translated-name)
    ;; (global-set-key (kbd "C-c e e") 'insert-translated-name-insert-original-translation)
    ;; (global-set-key (kbd "C-c e v") 'insert-translated-name-insert-with-camel)
    ;; (global-set-key (kbd "C-c e u") 'insert-translated-name-insert-with-underline)
    ;; (global-set-key (kbd "C-c e r") 'insert-translated-name-replace)


    ;; å†™è‹±æ–‡å¸®åŠ©
    ;; (require 'company-english-helper)
    ;; (global-set-key (kbd "C-c e h") 'toggle-company-english-helper)

    :bind
    (:map global-map
     ("C-c y" . aggron/translate-code-comment-command)
     ("C-c e y" . gts-do-translate)
     ("C-c e c" . aggron/translate-comment-copy-command)
     ;;("C-c e h" . toggle-company-english-helper)
     ("C-c e e" . insert-translated-name-insert-original-translation)
     ("C-c e v" . insert-translated-name-insert-with-camel)
     ("C-c e u" . insert-translated-name-insert-with-underline)
     ("C-c e r" . insert-translated-name-replace)
     )
    )

  ;; æœ‰é“è¯å…¸
  ;; (use-package youdao-dictionary
  ;;   :ensure t
  ;;   :bind
  ;;   (:map global-map
  ;; 		;; ä¼šè‡ªåŠ¨éšè—. ä½†æ˜¯å¯¹äºæŸ¥çœ‹é•¿æ–‡æ¡£ç¿»è¯‘æ—¶å€™,ä¸å¤ªæ–¹ä¾¿
  ;; 	;; ("C-c y" . youdao-dictionary-search-at-point-tooltip)
  ;; 	;; ä¸ä¼šç§»åŠ¨éšè—.ä½†æ˜¯æœ‰æ“ä½œä¼šéšè—
  ;; 	("C-c y" . youdao-dictionary-search-at-point+))
  ;;   :config
  ;;   ;; Enable Cache
  ;;   (setq url-automatic-caching t)
  ;;   ;; Integrate with popwin-el (https://github.com/m2ym/popwin-el)
  ;;   ;; (push "*Youdao Dictionary*" popwin:special-display-config)

  ;;   ;; Set file path for saving search history
  ;;   (setq youdao-dictionary-search-history-file "~/.emacs.d/.youdao")

  ;;   ;; Enable Chinese word segmentation support (æ”¯æŒä¸­æ–‡åˆ†è¯)
  ;;   ;; (setq youdao-dictionary-use-chinese-word-segmentation t)
  ;;   )

#+end_src

* org
#+begin_src emacs-lisp

  (setq org-agenda-files '("~/org/work/" "~/org/knowledge/"))


  ;; è®¾ç½® org-capture
  (setq org-capture-templates
        '(
          ;; å·¥ä½œç›¸å…³è®°å½•
          ;; ("w" "å·¥ä½œç›¸å…³") - æš‚ä¸åˆ†ç»„
          ("t" "å·¥ä½œä»»åŠ¡" entry
           (file+olp "~/org/work/work.org" "ä¸´æ—¶è®°å½•" "ä»»åŠ¡")
           "*** TODO %^{æ ‡é¢˜} :task:\n %?\n%U\n")
          ("b" "BUGè®°å½•" entry
           (file+olp "~/org/work/work.org" "ä¸´æ—¶è®°å½•" "BUG")
           "*** TODO %^{æ ‡é¢˜} :bug:\n %?\n%U\n")
          ("r" "å¤‡å¿˜ä¿¡æ¯" entry
           (file+olp "~/org/work/work.org" "å¤‡å¿˜å½•")
           "** %^{æ ‡é¢˜}\n %?\n%U\n")
          ("p" "è´¦å·å¯†ç " entry
           (file+olp "~/org/work/note.org" "è´¦å·å¯†ç ")
           "** %^{æ ‡é¢˜}\n  %?\n%U\n")
          ("d" "æ–‡æ¡£è®°å½•" entry
           (file+olp "~/org/work/note.org" "æ–‡æ¡£")
           "** %^{æ ‡é¢˜}\n %?\n")
          )
        )
  (setq org-todo-keywords
        '((sequence "TODO(t)" "DOING(i)" "HANGUP(h)" "|" "DONE(d)" "CANCEL(c)")
          (sequence "âš‘(T)" "ğŸ´(I)" "â“(H)" "|" "âœ”(D)" "âœ˜(C)"))
        org-todo-keyword-faces '(("HANGUP" . warning)
                                 ("â“" . warning))
        org-priority-faces '((?A . error)
                             (?B . warning)
                             (?C . success)))


  (require 'aggron-work)
  (setq aggron-work-file-title '(concat "#+startup: content\n"
                                        "#+title: " (format-time-string "%Y-%m-%dè®°å½•\n")
                                        "* å·¥ä½œè®°å½•\n* BUGåˆ†æ\n"))
  (if sys/win32p
      (setq aggron-work-dir "d:/org/work/record/"))

  (if sys/win32p
      (progn
        (setq org-default-notes-file (expand-file-name "d:/org/index.org"))
        (setq org-agenda-files '("d:/org/work/" "d:/org/knowledge/"))
        )
    (setq org-default-notes-file (expand-file-name "~/org/index.org"))
    (setq org-agenda-files '("~/org/work/" "~/org/knowledge/"))
    )
  (setq org-refile-targets '((org-agenda-files :maxlevel . 2)))

  ;; brew install pandoc pandoc-citeproc librsvg python homebrew/cask/basictex
  (use-package org-web-tools
    :ensure t)
  ;; ä½¿ç”¨ org-web-tools-read-url-as-org è½¬æ¢å‰ªåˆ‡æ¿ä¸­çš„è¿æ¥ä¸ºorg.å¹¶åœ¨æ–°ç¼“å†²åŒºä¸­æ‰“å¼€.
  ;; ä½¿ç”¨ org-web-tools-convert-links-to-page-entries	å°†entryä¸­çš„urlè½¬æ¢ä¸ºorg.å¹¶æ·»åŠ åˆ°å½“å‰entryä¸‹é¢

#+end_src

* jcn golang debug options
#+begin_src elisp
  (dap-register-debug-template "Game Server Party Unoptimized Debug"
                               (list :type "go"
                                     :request "launch"
                                     :name "PartyDebug"
                                     :mode "debug"
                                     :program "/Users/aggron/workspace/game-server-party/src"
                                     :buildFlags "-gcflags '-N -l' -ldflags '-X \"pkg.jcndev.com/game-framework/three-d.BaseDir=/Users/aggron/workspace/data/\"'"
                                     :args nil
                                     :env "CGO_ENABLED=\"0\""
                                     :envFile nil
                                     :workspace "/Users/aggron/workspace/game-server-party"
                                     :cwd "/Users/aggron/workspace/game-server-party"))

  (dap-register-debug-template "Gateway Unoptimized Debug"
                               (list :type "go"
                                     :request "launch"
                                     :name "GatewayDebug"
                                     :mode "debug"
                                     :program "/Users/aggron/workspace/game-gateway/src"
                                     :buildFlags "-gcflags '-N -l'"
                                     :args nil
                                     :env "CGO_ENABLED=\"0\""
                                     :envFile nil
                                     :workspace "/Users/aggron/workspace/game-gateway"
                                     :cwd "/Users/aggron/workspace/game-gateway"))
  ;;  (dap-go-setup)

#+end_src

* çŠ¶æ€æ 
#+begin_src emacs-lisp
  ;; åœ¨çŠ¶æ€æ æ˜¾ç¤ºæ—¶é—´
  (use-package time
    :ensure nil
    :custom ((display-time-format "[%eå· %H:%M å‘¨%u]")
             (display-time-use-mail-icon t))
    :config
    ;; https://www.gnu.org/software/emacs/manual/html_node/elisp/Time-Parsing.html
    (display-time-mode 1)
    )
#+end_src

* ä¿å­˜æ—¶å€™åˆ é™¤è¡Œå°¾ç©ºç™½ç¬¦
#+begin_src emacs-lisp
  ;;  (remove-hook 'before-save-hook 'delete-trailing-whitespace t)
#+end_src

* golang ç¦ç”¨æ³¨é‡Šè¡¥å…¨
#+begin_src elisp
  ;;(setf (lsp--client-completion-in-comments? (gethash 'gopls lsp-clients)) nil)

#+end_src
